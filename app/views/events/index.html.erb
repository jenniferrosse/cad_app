<% content_for(:title, 'Events')%>
<div class="container">
  <div class="row">
    <div class="col-md-10 col-md-offset-1">
      <h1 class="text-center">events</h1>
      <hr>
    </div>
  </div>

  <div class="row">
    <div class="col-sm-2 col-sm-offset-0 col-md-2 col-md-offset-1 ">
      <%= link_to 'Current', new_event_path %><br>
      <%= link_to 'Upcoming', new_event_path %><br>
      <%= link_to 'Past', new_event_path %><br>
      <%= link_to 'All', new_event_path %><br>
      <br>
      <% if admin_signed_in? %>
        <%= link_to 'New Event', new_event_path %>
      <% end %>
    </div>
    <div class="col-sm-10 col-md-8">
      <div class="row">
        <% @events.each do |event| %>
        <div class="col-xs-12 col-sm-3 col-md-3">
              <%= link_to image_tag(event.event_thumbnail.url(:small), class: "img-responsive aspect"), event %>
        </div><!-- end col -->
        <div class="col-xs-12 col-sm-9 col-md-9">
          <h3><%= link_to event.title, event %></h3>
          <strong><%= event.gallery.try(:gallery_name) %></strong><br>
            <%= event.gallery.try(:address) %><br>
            <br>
            <h4 class="uppercase">
              <%= event.start_date.strftime("%e %B %Y") %> 
              <% if event.end_date > event.start_date %>
                - <%= event.end_date.strftime("%e %B %Y") %>
              <% end %>
            </h4>
            <p class="text-justify"><% if event.description.length > 255 %>
              <%= truncate(event.description, length: 255) %>
              <%= link_to 'more...', '', class: "read-more-#{event.id}" %>
              <script>
                $('.read-more-<%= event.id %>').on('click', function(e) {
                  e.preventDefault()
                  $(this).parent().html('<%= escape_javascript event.description %>')
                })
              </script>
            <% else %>
              <%= event.description %>
            <% end %></p>
            <% if admin_signed_in? %>
              <%= link_to 'Delete', event, method: :delete, data: { confirm: 'Are you sure?' } %>
            <% end %>
            <hr>
          </div><!-- end col -->
        <% end %>
      </div>
    </div><!-- end row -->

  </div>
  
  <br>
  <p class="text-center">
    <% if admin_signed_in? %>
      <%= link_to 'New Event', new_event_path, class: "btn btn-default" %>
    <% end %>
  </p>
</div>


